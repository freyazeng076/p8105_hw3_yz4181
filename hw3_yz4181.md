hw3\_yz4181
================
Yuanyuan Zeng(yz4181)
10/12/2021

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──

    ## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
    ## ✓ tibble  3.1.4     ✓ dplyr   1.0.7
    ## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
    ## ✓ readr   2.0.1     ✓ forcats 0.5.1

    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

    ## 
    ## Attaching package: 'lubridate'

    ## The following objects are masked from 'package:base':
    ## 
    ##     date, intersect, setdiff, union

## Problem 1

``` r
data("instacart")

# find the number of aisle and aisle that the most items ordered from
aisles_df =
  instacart %>% 
  group_by(aisle_id, aisle) %>% 
  summarize(order_times = n()) %>% 
  arrange(desc(order_times))

nrow(aisles_df)
```

    ## [1] 134

``` r
head(aisles_df, 1)
```

    ## # A tibble: 1 × 3
    ## # Groups:   aisle_id [1]
    ##   aisle_id aisle            order_times
    ##      <int> <chr>                  <int>
    ## 1       83 fresh vegetables      150609

``` r
# making plot showing number of items order in each aisle
aisles_df %>% 
  filter(
    order_times > 10000) %>% 
  ggplot(aes(x = aisle_id, y = order_times)) +
  geom_point(alpha = .5) +
  labs(
    title = "Number of items ordered from each aisle",
    x = "Aisle_id",
    y = "Number of items ordered") + 
  theme_bw()
```

![](hw3_yz4181_files/figure-gfm/unnamed-chunk-2-1.png)<!-- -->

``` r
# Table showing most popular items in three aisles
most_popular_item = 
  instacart %>% 
  filter(
    aisle == "baking ingredients" | 
    aisle =="dog food care" | 
    aisle =="packaged vegetables fruits"
    ) %>% 
  group_by(aisle,product_name) %>% 
  summarize(number_of_order_times = n()) %>% 
  mutate(
    order_ranking = min_rank(desc(number_of_order_times))
  ) %>% 
  filter(order_ranking < 4)

most_popular_item
```

    ## # A tibble: 9 × 4
    ## # Groups:   aisle [3]
    ##   aisle                      product_name        number_of_order_… order_ranking
    ##   <chr>                      <chr>                           <int>         <int>
    ## 1 baking ingredients         Cane Sugar                        336             3
    ## 2 baking ingredients         Light Brown Sugar                 499             1
    ## 3 baking ingredients         Pure Baking Soda                  387             2
    ## 4 dog food care              Organix Chicken & …                28             2
    ## 5 dog food care              Small Dog Biscuits                 26             3
    ## 6 dog food care              Snack Sticks Chick…                30             1
    ## 7 packaged vegetables fruits Organic Baby Spina…              9784             1
    ## 8 packaged vegetables fruits Organic Blueberries              4966             3
    ## 9 packaged vegetables fruits Organic Raspberries              5546             2

``` r
# Table showing mean hour of the day
mean_hour_of_the_day =
  instacart %>% 
  filter(
    product_name == "Pink Lady Apples" | 
    product_name == "Coffee Ice Cream") %>% 
  select(
    product_name,
    order_dow,
    order_hour_of_day) %>% 
  mutate(
    order_dow = wday(order_dow + 1, label = TRUE)) %>% 
  group_by(
    product_name,
    order_dow) %>% 
  summarize(
    mean_order_hour_of_day = mean(order_hour_of_day)) %>% 
  pivot_wider(
    names_from = order_dow,
    values_from = mean_order_hour_of_day
  )

mean_hour_of_the_day
```

    ## # A tibble: 2 × 8
    ## # Groups:   product_name [2]
    ##   product_name       Sun   Mon   Tue   Wed   Thu   Fri   Sat
    ##   <chr>            <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
    ## 1 Coffee Ice Cream  13.8  14.3  15.4  15.3  15.2  12.3  13.8
    ## 2 Pink Lady Apples  13.4  11.4  11.7  14.2  11.6  12.8  11.9

Summary:

In the aisles\_df, there are 134 rows and 3 variables which are
aisle\_id, aisle, and order\_times. From this table, we know that there
are 134 aisles and the aisle 83 which is corresponding to fresh
vegetables is being ordered the most. From the plot, we notice that
there are two aisle which are being ordered most. The data frame of most
popular items have 9 rows and 4 variables which are aisle,
product\_name, number of order times, and order ranking. The most
popular items in “baking ingredients” are ‘Cane Sugar’, ‘Light Brown
Sugar’, and ‘Pure Baking Soda’; in “dog food care” are ‘Organix Chicken
& Brown Rice Recipe’, ‘Small Dog Biscuits’, and ‘Snack Sticks Chicken &
Rice Recipe Dog Treats’; in “packaged vegetables fruits” are ‘Organic
Baby Spinach’, ‘Organic Blueberries’, and ‘Organic Raspberries’. The
table of mean hour of the day includes 2 rows which are ‘Pink Lady
Apples’ and ‘Coffee Ice Cream’ and 8 variables which are corresponding
to seven days in a week. The mean hour of the day at which Pink Lady
Apples and Coffee Ice Cream are ordered on each day of the week is
calculated.

## Problem 2

``` r
data("brfss_smart2010")

# Clean the data
brfss =
  brfss_smart2010 %>% 
  janitor::clean_names() %>% 
  filter(topic == "Overall Health",
         response != "Excellent" |
         response != "Poor" |
         response != "Very good"|
         response != "Good" |
         response != "Fair") %>% 
  mutate(
    response = forcats::fct_relevel(response, c("Poor", "Fair", "Good", "Very good", "Excellent"))
  )
```

``` r
# Find the states which were observed at 7 or more locations in 2002
locations_2002 =
  brfss %>% 
  filter(year == 2002) %>% 
  group_by(locationabbr) %>% 
  summarize(n_obs = n()) %>% 
  filter(n_obs >=7)

nrow(locations_2002)
```

    ## [1] 36

``` r
pull(locations_2002,locationabbr)
```

    ##  [1] "AZ" "CO" "CT" "DE" "FL" "GA" "HI" "ID" "IL" "IN" "KS" "LA" "MA" "MD" "ME"
    ## [16] "MI" "MN" "MO" "NC" "NE" "NH" "NJ" "NV" "NY" "OH" "OK" "OR" "PA" "RI" "SC"
    ## [31] "SD" "TN" "TX" "UT" "VT" "WA"

``` r
# Find the states which were observed at 7 or more locations in 2010
locations_2010 = 
  brfss %>% 
  filter(year == 2010) %>% 
  group_by(locationabbr) %>% 
  summarize(n_obs = n()) %>% 
  filter(n_obs >=7)

nrow(locations_2010)
```

    ## [1] 45

``` r
pull(locations_2010,locationabbr)
```

    ##  [1] "AL" "AR" "AZ" "CA" "CO" "CT" "DE" "FL" "GA" "HI" "IA" "ID" "IL" "IN" "KS"
    ## [16] "LA" "MA" "MD" "ME" "MI" "MN" "MO" "MS" "MT" "NC" "ND" "NE" "NH" "NJ" "NM"
    ## [31] "NV" "NY" "OH" "OK" "OR" "PA" "RI" "SC" "SD" "TN" "TX" "UT" "VT" "WA" "WY"

-   There are 36 states that were observed at 7 or more locations in
    2002 and the names of locations are listed above.

-   There are 45 states that were observed at 7 or more location in 2010
    and the names of locations are listed above

``` r
# Construct a data set and make a "spaghetti" plot
excellent_response = 
  brfss %>% 
  filter(response == "Excellent") %>% 
  select(year, locationabbr, data_value) %>% 
  group_by(year, locationabbr) %>% 
  summarize(average_data_value = mean(data_value))
```

    ## `summarise()` has grouped output by 'year'. You can override using the `.groups` argument.

``` r
excellent_response %>% 
  ggplot(aes(x = year, y = average_data_value, color = locationabbr))+
  geom_line() +
  labs(
    title = "Average value over time within a state",
    x = "Year",
    y = "Average data value"
  ) 
```

    ## Warning: Removed 3 row(s) containing missing values (geom_path).

![](hw3_yz4181_files/figure-gfm/unnamed-chunk-6-1.png)<!-- -->

``` r
# Make two-panel plot
NY_2006 = 
  brfss %>%
  filter(locationabbr == "NY") 
```

## Problem 3

``` r
accel_df = 
  read_csv("accel_data.csv") %>% 
  janitor::clean_names() 
```

    ## Rows: 35 Columns: 1443

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr    (1): day
    ## dbl (1442): week, day_id, activity.1, activity.2, activity.3, activity.4, ac...

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
